{"id":"H99C","dependencies":[{"name":"C:\\Users\\logan\\Projects\\census\\granicus\\package.json","includedInParent":true,"mtime":1554919336134},{"name":"lodash","loc":{"line":1,"column":14},"parent":"C:\\Users\\logan\\Projects\\census\\granicus\\src\\index.js","resolved":"C:\\Users\\logan\\Projects\\census\\granicus\\node_modules\\lodash\\lodash.js"}],"generated":{"js":"\"use strict\";var t=e(require(\"lodash\"));function e(t){return t&&t.__esModule?t:{default:t}}function a(t,e,a,n,o,r,u){try{var i=t[r](u),c=i.value}catch(s){return void a(s)}i.done?e(c):Promise.resolve(c).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise(function(o,r){var u=t.apply(e,n);function i(t){a(u,o,r,i,c,\"next\",t)}function c(t){a(u,o,r,i,c,\"throw\",t)}i(void 0)})}}!function(){var t=tableau.makeConnector();t.getSchema=function(t){t([{id:\"counts\",alias:\"Counts\",columns:[{id:\"name\",alias:\"Name of Metric\",dataType:tableau.dataTypeEnum.int},{id:\"this_wk\",alias:\"This Week\",dataType:tableau.dataTypeEnum.int},{id:\"prev_wk\",alias:\"Previous Week\",dataType:tableau.dataTypeEnum.int},{id:\"three_wk\",alias:\"Three Weeks Ago\",dataType:tableau.dataTypeEnum.int}]}])},t.getData=function(e,a){var n=JSON.parse(tableau.connectionData),o=(n.key,new Date(n.end_date)),r=o.getUTCMonth()+1,u=o.getUTCDate(),i=o.getUTCFullYear()+\"-\"+r+\"-\"+u,c=(new Date).setDate(o.getDate()-7),s=c.getUTCMonth()+1,l=c.getUTCDate(),d=c.getUTCFullYear()+\"-\"+s+\"-\"+l,g=(new Date).setDate(o.getDate()-14),m=g.getUTCMonth()+1,T=g.getUTCDate(),p=g.getUTCFullYear()+\"-\"+m+\"-\"+T,D=(new Date).setDate(o.getDate()-21),y=D.getUTCMonth()+1,C=D.getUTCDate(),h=D.getUTCFullYear()+\"-\"+y+\"-\"+C,v=(new Date).setDate(o.getDate()-30),b=v.getUTCMonth()+1,f=v.getUTCDate(),U=(v.getUTCFullYear(),\"https://cors-e.herokuapp.com/https://api.govdelivery.com/api/v2/accounts/11723\");\"reports/bulletins/summary?start_date=\".concat(d,\"&end_date=\").concat(i),\"reports/bulletins/summary?start_date=\".concat(p,\"&end_date=\").concat(d),\"reports/bulletins/summary?start_date=\".concat(h,\"&end_date=\").concat(p);tableau.registerConnector(t),$(document).ready(function(){$(\"#submitButton\").click(function(){var t={key:$(\"#apiKey\").val().trim(),end_date:$(\"#end_date\").val().trim()};tableau.connectionData=JSON.stringify(t),tableau.connectionName=\"Granicus WDC\",tableau.submit()})})}}();"},"sourceMaps":{"js":{"mappings":[{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":0}},{"source":"src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":13}},{"source":"src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":17}},{"source":"src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":19}},{"source":"src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":21}},{"source":"src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":29}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":40}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":49}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":51}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":54}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":61}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":64}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":66}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":77}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":79}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":80}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":88}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":91}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":100}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":102}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":104}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":106}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":108}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":110}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":112}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":114}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":117}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":121}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":125}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":127}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":129}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":132}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":135}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":137}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":139}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":145}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":151}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":154}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":166}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":168}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":171}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":173}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":178}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":180}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":183}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":191}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":199}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":202}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":207}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":209}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":212}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":221}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":223}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":226}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":233}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":244}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":248}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":250}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":255}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":257}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":267}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":274}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":278}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":286}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":295}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":297}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":300}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":304}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":306}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":308}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":314}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":316}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":319}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":328}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":330}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":333}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":335}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":337}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":339}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":341}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":343}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":345}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":352}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":355}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":364}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":366}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":369}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":371}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":373}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":375}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":377}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":379}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":381}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":389}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":392}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":399}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":406}},{"source":"src/index.js","name":"account","original":{"line":5,"column":6},"generated":{"line":1,"column":417}},{"source":"src/index.js","name":"myConnector","original":{"line":6,"column":6},"generated":{"line":1,"column":421}},{"source":"src/index.js","name":"tableau","original":{"line":6,"column":20},"generated":{"line":1,"column":423}},{"source":"src/index.js","name":"makeConnector","original":{"line":6,"column":28},"generated":{"line":1,"column":431}},{"source":"src/index.js","name":"myConnector","original":{"line":9,"column":2},"generated":{"line":1,"column":447}},{"source":"src/index.js","name":"getSchema","original":{"line":9,"column":14},"generated":{"line":1,"column":449}},{"source":"src/index.js","original":{"line":9,"column":26},"generated":{"line":1,"column":459}},{"source":"src/index.js","name":"schemaCallback","original":{"line":9,"column":36},"generated":{"line":1,"column":468}},{"source":"src/index.js","name":"schemaCallback","original":{"line":74,"column":4},"generated":{"line":1,"column":471}},{"source":"src/index.js","original":{"line":74,"column":19},"generated":{"line":1,"column":473}},{"source":"src/index.js","original":{"line":68,"column":17},"generated":{"line":1,"column":474}},{"source":"src/index.js","name":"id","original":{"line":69,"column":6},"generated":{"line":1,"column":475}},{"source":"src/index.js","original":{"line":69,"column":10},"generated":{"line":1,"column":478}},{"source":"src/index.js","name":"alias","original":{"line":70,"column":6},"generated":{"line":1,"column":487}},{"source":"src/index.js","original":{"line":70,"column":13},"generated":{"line":1,"column":493}},{"source":"src/index.js","name":"columns","original":{"line":71,"column":6},"generated":{"line":1,"column":502}},{"source":"src/index.js","original":{"line":45,"column":23},"generated":{"line":1,"column":510}},{"source":"src/index.js","original":{"line":45,"column":24},"generated":{"line":1,"column":511}},{"source":"src/index.js","name":"id","original":{"line":46,"column":6},"generated":{"line":1,"column":512}},{"source":"src/index.js","original":{"line":46,"column":10},"generated":{"line":1,"column":515}},{"source":"src/index.js","name":"alias","original":{"line":47,"column":6},"generated":{"line":1,"column":522}},{"source":"src/index.js","original":{"line":47,"column":13},"generated":{"line":1,"column":528}},{"source":"src/index.js","name":"dataType","original":{"line":48,"column":6},"generated":{"line":1,"column":545}},{"source":"src/index.js","name":"tableau","original":{"line":48,"column":16},"generated":{"line":1,"column":554}},{"source":"src/index.js","name":"dataTypeEnum","original":{"line":48,"column":24},"generated":{"line":1,"column":562}},{"source":"src/index.js","name":"int","original":{"line":48,"column":37},"generated":{"line":1,"column":575}},{"source":"src/index.js","original":{"line":50,"column":4},"generated":{"line":1,"column":580}},{"source":"src/index.js","name":"id","original":{"line":51,"column":6},"generated":{"line":1,"column":581}},{"source":"src/index.js","original":{"line":51,"column":10},"generated":{"line":1,"column":584}},{"source":"src/index.js","name":"alias","original":{"line":52,"column":6},"generated":{"line":1,"column":594}},{"source":"src/index.js","original":{"line":52,"column":13},"generated":{"line":1,"column":600}},{"source":"src/index.js","name":"dataType","original":{"line":53,"column":6},"generated":{"line":1,"column":612}},{"source":"src/index.js","name":"tableau","original":{"line":53,"column":16},"generated":{"line":1,"column":621}},{"source":"src/index.js","name":"dataTypeEnum","original":{"line":53,"column":24},"generated":{"line":1,"column":629}},{"source":"src/index.js","name":"int","original":{"line":53,"column":37},"generated":{"line":1,"column":642}},{"source":"src/index.js","original":{"line":55,"column":4},"generated":{"line":1,"column":647}},{"source":"src/index.js","name":"id","original":{"line":56,"column":6},"generated":{"line":1,"column":648}},{"source":"src/index.js","original":{"line":56,"column":10},"generated":{"line":1,"column":651}},{"source":"src/index.js","name":"alias","original":{"line":57,"column":6},"generated":{"line":1,"column":661}},{"source":"src/index.js","original":{"line":57,"column":13},"generated":{"line":1,"column":667}},{"source":"src/index.js","name":"dataType","original":{"line":58,"column":6},"generated":{"line":1,"column":683}},{"source":"src/index.js","name":"tableau","original":{"line":58,"column":16},"generated":{"line":1,"column":692}},{"source":"src/index.js","name":"dataTypeEnum","original":{"line":58,"column":24},"generated":{"line":1,"column":700}},{"source":"src/index.js","name":"int","original":{"line":58,"column":37},"generated":{"line":1,"column":713}},{"source":"src/index.js","original":{"line":60,"column":4},"generated":{"line":1,"column":718}},{"source":"src/index.js","name":"id","original":{"line":61,"column":6},"generated":{"line":1,"column":719}},{"source":"src/index.js","original":{"line":61,"column":10},"generated":{"line":1,"column":722}},{"source":"src/index.js","name":"alias","original":{"line":62,"column":6},"generated":{"line":1,"column":733}},{"source":"src/index.js","original":{"line":62,"column":13},"generated":{"line":1,"column":739}},{"source":"src/index.js","name":"dataType","original":{"line":63,"column":6},"generated":{"line":1,"column":757}},{"source":"src/index.js","name":"tableau","original":{"line":63,"column":16},"generated":{"line":1,"column":766}},{"source":"src/index.js","name":"dataTypeEnum","original":{"line":63,"column":24},"generated":{"line":1,"column":774}},{"source":"src/index.js","name":"int","original":{"line":63,"column":37},"generated":{"line":1,"column":787}},{"source":"src/index.js","name":"myConnector","original":{"line":77,"column":2},"generated":{"line":1,"column":797}},{"source":"src/index.js","name":"getData","original":{"line":77,"column":14},"generated":{"line":1,"column":799}},{"source":"src/index.js","original":{"line":77,"column":24},"generated":{"line":1,"column":807}},{"source":"src/index.js","name":"table","original":{"line":77,"column":34},"generated":{"line":1,"column":816}},{"source":"src/index.js","name":"doneCallback","original":{"line":77,"column":41},"generated":{"line":1,"column":818}},{"source":"src/index.js","name":"data","original":{"line":81,"column":8},"generated":{"line":1,"column":821}},{"source":"src/index.js","name":"data","original":{"line":81,"column":8},"generated":{"line":1,"column":825}},{"source":"src/index.js","name":"JSON","original":{"line":81,"column":15},"generated":{"line":1,"column":827}},{"source":"src/index.js","name":"parse","original":{"line":81,"column":20},"generated":{"line":1,"column":832}},{"source":"src/index.js","name":"tableau","original":{"line":81,"column":26},"generated":{"line":1,"column":838}},{"source":"src/index.js","name":"connectionData","original":{"line":81,"column":34},"generated":{"line":1,"column":846}},{"source":"src/index.js","name":"end_date","original":{"line":85,"column":8},"generated":{"line":1,"column":862}},{"source":"src/index.js","name":"data","original":{"line":82,"column":14},"generated":{"line":1,"column":865}},{"source":"src/index.js","name":"key","original":{"line":82,"column":19},"generated":{"line":1,"column":867}},{"source":"src/index.js","original":{"line":85,"column":19},"generated":{"line":1,"column":871}},{"source":"src/index.js","name":"Date","original":{"line":85,"column":23},"generated":{"line":1,"column":875}},{"source":"src/index.js","name":"data","original":{"line":85,"column":28},"generated":{"line":1,"column":880}},{"source":"src/index.js","name":"end_date","original":{"line":85,"column":33},"generated":{"line":1,"column":882}},{"source":"src/index.js","name":"month","original":{"line":86,"column":8},"generated":{"line":1,"column":893}},{"source":"src/index.js","name":"end_date","original":{"line":86,"column":16},"generated":{"line":1,"column":895}},{"source":"src/index.js","name":"getUTCMonth","original":{"line":86,"column":25},"generated":{"line":1,"column":897}},{"source":"src/index.js","original":{"line":86,"column":41},"generated":{"line":1,"column":911}},{"source":"src/index.js","name":"day","original":{"line":87,"column":8},"generated":{"line":1,"column":913}},{"source":"src/index.js","name":"end_date","original":{"line":87,"column":14},"generated":{"line":1,"column":915}},{"source":"src/index.js","name":"getUTCDate","original":{"line":87,"column":23},"generated":{"line":1,"column":917}},{"source":"src/index.js","name":"new_date","original":{"line":89,"column":8},"generated":{"line":1,"column":930}},{"source":"src/index.js","name":"end_date","original":{"line":88,"column":15},"generated":{"line":1,"column":932}},{"source":"src/index.js","name":"getUTCFullYear","original":{"line":88,"column":24},"generated":{"line":1,"column":934}},{"source":"src/index.js","original":{"line":89,"column":26},"generated":{"line":1,"column":951}},{"source":"src/index.js","name":"month","original":{"line":89,"column":32},"generated":{"line":1,"column":955}},{"source":"src/index.js","original":{"line":89,"column":40},"generated":{"line":1,"column":957}},{"source":"src/index.js","name":"day","original":{"line":89,"column":46},"generated":{"line":1,"column":961}},{"source":"src/index.js","name":"wks_1","original":{"line":92,"column":8},"generated":{"line":1,"column":963}},{"source":"src/index.js","original":{"line":92,"column":16},"generated":{"line":1,"column":966}},{"source":"src/index.js","name":"Date","original":{"line":92,"column":20},"generated":{"line":1,"column":970}},{"source":"src/index.js","name":"setDate","original":{"line":92,"column":27},"generated":{"line":1,"column":976}},{"source":"src/index.js","name":"end_date","original":{"line":92,"column":35},"generated":{"line":1,"column":984}},{"source":"src/index.js","name":"getDate","original":{"line":92,"column":44},"generated":{"line":1,"column":986}},{"source":"src/index.js","original":{"line":92,"column":56},"generated":{"line":1,"column":996}},{"source":"src/index.js","name":"wks_1_month","original":{"line":93,"column":8},"generated":{"line":1,"column":999}},{"source":"src/index.js","name":"wks_1","original":{"line":93,"column":22},"generated":{"line":1,"column":1001}},{"source":"src/index.js","name":"getUTCMonth","original":{"line":93,"column":28},"generated":{"line":1,"column":1003}},{"source":"src/index.js","original":{"line":93,"column":44},"generated":{"line":1,"column":1017}},{"source":"src/index.js","name":"wks_1_day","original":{"line":94,"column":8},"generated":{"line":1,"column":1019}},{"source":"src/index.js","name":"wks_1","original":{"line":94,"column":20},"generated":{"line":1,"column":1021}},{"source":"src/index.js","name":"getUTCDate","original":{"line":94,"column":26},"generated":{"line":1,"column":1023}},{"source":"src/index.js","name":"wks_1_date","original":{"line":96,"column":8},"generated":{"line":1,"column":1036}},{"source":"src/index.js","name":"wks_1","original":{"line":95,"column":21},"generated":{"line":1,"column":1038}},{"source":"src/index.js","name":"getUTCFullYear","original":{"line":95,"column":27},"generated":{"line":1,"column":1040}},{"source":"src/index.js","original":{"line":96,"column":34},"generated":{"line":1,"column":1057}},{"source":"src/index.js","name":"wks_1_month","original":{"line":96,"column":40},"generated":{"line":1,"column":1061}},{"source":"src/index.js","original":{"line":96,"column":54},"generated":{"line":1,"column":1063}},{"source":"src/index.js","name":"wks_1_day","original":{"line":96,"column":60},"generated":{"line":1,"column":1067}},{"source":"src/index.js","name":"wks_2","original":{"line":99,"column":8},"generated":{"line":1,"column":1069}},{"source":"src/index.js","original":{"line":99,"column":16},"generated":{"line":1,"column":1072}},{"source":"src/index.js","name":"Date","original":{"line":99,"column":20},"generated":{"line":1,"column":1076}},{"source":"src/index.js","name":"setDate","original":{"line":99,"column":27},"generated":{"line":1,"column":1082}},{"source":"src/index.js","name":"end_date","original":{"line":99,"column":35},"generated":{"line":1,"column":1090}},{"source":"src/index.js","name":"getDate","original":{"line":99,"column":44},"generated":{"line":1,"column":1092}},{"source":"src/index.js","original":{"line":99,"column":56},"generated":{"line":1,"column":1102}},{"source":"src/index.js","name":"wks_2_month","original":{"line":100,"column":8},"generated":{"line":1,"column":1106}},{"source":"src/index.js","name":"wks_2","original":{"line":100,"column":22},"generated":{"line":1,"column":1108}},{"source":"src/index.js","name":"getUTCMonth","original":{"line":100,"column":28},"generated":{"line":1,"column":1110}},{"source":"src/index.js","original":{"line":100,"column":44},"generated":{"line":1,"column":1124}},{"source":"src/index.js","name":"wks_2_day","original":{"line":101,"column":8},"generated":{"line":1,"column":1126}},{"source":"src/index.js","name":"wks_2","original":{"line":101,"column":20},"generated":{"line":1,"column":1128}},{"source":"src/index.js","name":"getUTCDate","original":{"line":101,"column":26},"generated":{"line":1,"column":1130}},{"source":"src/index.js","name":"wks_2_date","original":{"line":103,"column":8},"generated":{"line":1,"column":1143}},{"source":"src/index.js","name":"wks_2","original":{"line":102,"column":21},"generated":{"line":1,"column":1145}},{"source":"src/index.js","name":"getUTCFullYear","original":{"line":102,"column":27},"generated":{"line":1,"column":1147}},{"source":"src/index.js","original":{"line":103,"column":34},"generated":{"line":1,"column":1164}},{"source":"src/index.js","name":"wks_2_month","original":{"line":103,"column":40},"generated":{"line":1,"column":1168}},{"source":"src/index.js","original":{"line":103,"column":54},"generated":{"line":1,"column":1170}},{"source":"src/index.js","name":"wks_2_day","original":{"line":103,"column":60},"generated":{"line":1,"column":1174}},{"source":"src/index.js","name":"wks_3","original":{"line":106,"column":8},"generated":{"line":1,"column":1176}},{"source":"src/index.js","original":{"line":106,"column":16},"generated":{"line":1,"column":1179}},{"source":"src/index.js","name":"Date","original":{"line":106,"column":20},"generated":{"line":1,"column":1183}},{"source":"src/index.js","name":"setDate","original":{"line":106,"column":27},"generated":{"line":1,"column":1189}},{"source":"src/index.js","name":"end_date","original":{"line":106,"column":35},"generated":{"line":1,"column":1197}},{"source":"src/index.js","name":"getDate","original":{"line":106,"column":44},"generated":{"line":1,"column":1199}},{"source":"src/index.js","original":{"line":106,"column":56},"generated":{"line":1,"column":1209}},{"source":"src/index.js","name":"wks_3_month","original":{"line":107,"column":8},"generated":{"line":1,"column":1213}},{"source":"src/index.js","name":"wks_3","original":{"line":107,"column":22},"generated":{"line":1,"column":1215}},{"source":"src/index.js","name":"getUTCMonth","original":{"line":107,"column":28},"generated":{"line":1,"column":1217}},{"source":"src/index.js","original":{"line":107,"column":44},"generated":{"line":1,"column":1231}},{"source":"src/index.js","name":"wks_3_day","original":{"line":108,"column":8},"generated":{"line":1,"column":1233}},{"source":"src/index.js","name":"wks_3","original":{"line":108,"column":20},"generated":{"line":1,"column":1235}},{"source":"src/index.js","name":"getUTCDate","original":{"line":108,"column":26},"generated":{"line":1,"column":1237}},{"source":"src/index.js","name":"wks_3_date","original":{"line":110,"column":8},"generated":{"line":1,"column":1250}},{"source":"src/index.js","name":"wks_3","original":{"line":109,"column":21},"generated":{"line":1,"column":1252}},{"source":"src/index.js","name":"getUTCFullYear","original":{"line":109,"column":27},"generated":{"line":1,"column":1254}},{"source":"src/index.js","original":{"line":110,"column":34},"generated":{"line":1,"column":1271}},{"source":"src/index.js","name":"wks_3_month","original":{"line":110,"column":40},"generated":{"line":1,"column":1275}},{"source":"src/index.js","original":{"line":110,"column":54},"generated":{"line":1,"column":1277}},{"source":"src/index.js","name":"wks_3_day","original":{"line":110,"column":60},"generated":{"line":1,"column":1281}},{"source":"src/index.js","name":"monthAgo","original":{"line":113,"column":8},"generated":{"line":1,"column":1283}},{"source":"src/index.js","original":{"line":113,"column":19},"generated":{"line":1,"column":1286}},{"source":"src/index.js","name":"Date","original":{"line":113,"column":23},"generated":{"line":1,"column":1290}},{"source":"src/index.js","name":"setDate","original":{"line":113,"column":30},"generated":{"line":1,"column":1296}},{"source":"src/index.js","name":"end_date","original":{"line":113,"column":38},"generated":{"line":1,"column":1304}},{"source":"src/index.js","name":"getDate","original":{"line":113,"column":47},"generated":{"line":1,"column":1306}},{"source":"src/index.js","original":{"line":113,"column":59},"generated":{"line":1,"column":1316}},{"source":"src/index.js","name":"monthAgoM","original":{"line":114,"column":8},"generated":{"line":1,"column":1320}},{"source":"src/index.js","name":"monthAgo","original":{"line":114,"column":20},"generated":{"line":1,"column":1322}},{"source":"src/index.js","name":"getUTCMonth","original":{"line":114,"column":29},"generated":{"line":1,"column":1324}},{"source":"src/index.js","original":{"line":114,"column":45},"generated":{"line":1,"column":1338}},{"source":"src/index.js","name":"monthAgoD","original":{"line":115,"column":8},"generated":{"line":1,"column":1340}},{"source":"src/index.js","name":"monthAgo","original":{"line":115,"column":20},"generated":{"line":1,"column":1342}},{"source":"src/index.js","name":"getUTCDate","original":{"line":115,"column":29},"generated":{"line":1,"column":1344}},{"source":"src/index.js","name":"base_url","original":{"line":121,"column":8},"generated":{"line":1,"column":1357}},{"source":"src/index.js","name":"monthAgo","original":{"line":116,"column":20},"generated":{"line":1,"column":1360}},{"source":"src/index.js","name":"getUTCFullYear","original":{"line":116,"column":29},"generated":{"line":1,"column":1362}},{"source":"src/index.js","original":{"line":121,"column":19},"generated":{"line":1,"column":1379}},{"source":"src/index.js","name":"wks_1_date","original":{"line":123,"column":82},"generated":{"line":1,"column":1461}},{"source":"src/index.js","name":"wks_1_date","original":{"line":123,"column":82},"generated":{"line":1,"column":1501}},{"source":"src/index.js","name":"wks_1_date","original":{"line":123,"column":82},"generated":{"line":1,"column":1508}},{"source":"src/index.js","name":"new_date","original":{"line":123,"column":105},"generated":{"line":1,"column":1510}},{"source":"src/index.js","name":"new_date","original":{"line":123,"column":105},"generated":{"line":1,"column":1524}},{"source":"src/index.js","name":"new_date","original":{"line":123,"column":105},"generated":{"line":1,"column":1531}},{"source":"src/index.js","name":"wks_2_date","original":{"line":124,"column":83},"generated":{"line":1,"column":1534}},{"source":"src/index.js","name":"wks_2_date","original":{"line":124,"column":83},"generated":{"line":1,"column":1574}},{"source":"src/index.js","name":"wks_2_date","original":{"line":124,"column":83},"generated":{"line":1,"column":1581}},{"source":"src/index.js","name":"wks_1_date","original":{"line":124,"column":106},"generated":{"line":1,"column":1583}},{"source":"src/index.js","name":"wks_1_date","original":{"line":124,"column":106},"generated":{"line":1,"column":1597}},{"source":"src/index.js","name":"wks_1_date","original":{"line":124,"column":106},"generated":{"line":1,"column":1604}},{"source":"src/index.js","name":"wks_3_date","original":{"line":125,"column":83},"generated":{"line":1,"column":1607}},{"source":"src/index.js","name":"wks_3_date","original":{"line":125,"column":83},"generated":{"line":1,"column":1647}},{"source":"src/index.js","name":"wks_3_date","original":{"line":125,"column":83},"generated":{"line":1,"column":1654}},{"source":"src/index.js","name":"wks_2_date","original":{"line":125,"column":106},"generated":{"line":1,"column":1656}},{"source":"src/index.js","name":"wks_2_date","original":{"line":125,"column":106},"generated":{"line":1,"column":1670}},{"source":"src/index.js","name":"wks_2_date","original":{"line":125,"column":106},"generated":{"line":1,"column":1677}},{"source":"src/index.js","name":"tableau","original":{"line":229,"column":4},"generated":{"line":1,"column":1680}},{"source":"src/index.js","name":"registerConnector","original":{"line":229,"column":12},"generated":{"line":1,"column":1688}},{"source":"src/index.js","name":"myConnector","original":{"line":229,"column":30},"generated":{"line":1,"column":1706}},{"source":"src/index.js","name":"$","original":{"line":232,"column":4},"generated":{"line":1,"column":1709}},{"source":"src/index.js","name":"document","original":{"line":232,"column":6},"generated":{"line":1,"column":1711}},{"source":"src/index.js","name":"ready","original":{"line":232,"column":16},"generated":{"line":1,"column":1721}},{"source":"src/index.js","original":{"line":232,"column":22},"generated":{"line":1,"column":1727}},{"source":"src/index.js","name":"$","original":{"line":233,"column":6},"generated":{"line":1,"column":1738}},{"source":"src/index.js","original":{"line":233,"column":8},"generated":{"line":1,"column":1740}},{"source":"src/index.js","name":"click","original":{"line":233,"column":25},"generated":{"line":1,"column":1757}},{"source":"src/index.js","original":{"line":233,"column":31},"generated":{"line":1,"column":1763}},{"source":"src/index.js","name":"pass","original":{"line":235,"column":12},"generated":{"line":1,"column":1774}},{"source":"src/index.js","name":"pass","original":{"line":235,"column":12},"generated":{"line":1,"column":1778}},{"source":"src/index.js","original":{"line":235,"column":19},"generated":{"line":1,"column":1780}},{"source":"src/index.js","name":"key","original":{"line":236,"column":10},"generated":{"line":1,"column":1781}},{"source":"src/index.js","name":"$","original":{"line":236,"column":15},"generated":{"line":1,"column":1785}},{"source":"src/index.js","original":{"line":236,"column":17},"generated":{"line":1,"column":1787}},{"source":"src/index.js","name":"val","original":{"line":236,"column":28},"generated":{"line":1,"column":1798}},{"source":"src/index.js","name":"trim","original":{"line":236,"column":34},"generated":{"line":1,"column":1804}},{"source":"src/index.js","name":"end_date","original":{"line":237,"column":10},"generated":{"line":1,"column":1811}},{"source":"src/index.js","name":"$","original":{"line":237,"column":21},"generated":{"line":1,"column":1820}},{"source":"src/index.js","original":{"line":237,"column":23},"generated":{"line":1,"column":1822}},{"source":"src/index.js","name":"val","original":{"line":237,"column":36},"generated":{"line":1,"column":1835}},{"source":"src/index.js","name":"trim","original":{"line":237,"column":42},"generated":{"line":1,"column":1841}},{"source":"src/index.js","name":"tableau","original":{"line":240,"column":8},"generated":{"line":1,"column":1849}},{"source":"src/index.js","name":"connectionData","original":{"line":240,"column":16},"generated":{"line":1,"column":1857}},{"source":"src/index.js","name":"JSON","original":{"line":240,"column":33},"generated":{"line":1,"column":1872}},{"source":"src/index.js","name":"stringify","original":{"line":240,"column":38},"generated":{"line":1,"column":1877}},{"source":"src/index.js","name":"pass","original":{"line":240,"column":48},"generated":{"line":1,"column":1887}},{"source":"src/index.js","name":"tableau","original":{"line":242,"column":8},"generated":{"line":1,"column":1890}},{"source":"src/index.js","name":"connectionName","original":{"line":242,"column":16},"generated":{"line":1,"column":1898}},{"source":"src/index.js","original":{"line":242,"column":33},"generated":{"line":1,"column":1913}},{"source":"src/index.js","name":"tableau","original":{"line":244,"column":8},"generated":{"line":1,"column":1928}},{"source":"src/index.js","name":"submit","original":{"line":244,"column":16},"generated":{"line":1,"column":1936}},{"source":"src/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":1950}}],"sources":{"src/index.js":"import _ from \"lodash\"\r\n\r\n(function () {\r\n  // Create the connector object\r\n  let account = \"11723\"\r\n  let myConnector = tableau.makeConnector();\r\n  \r\n  // Define the schema\r\n  myConnector.getSchema = function (schemaCallback) {\r\n\r\n    // Rates are float types, so breaking out into separate tables\r\n    // let rate_schema = [{\r\n    //   id: \"name\",\r\n    //   alias: \"Name of Metric\",\r\n    //   dataType: tableau.dataTypeEnum.float\r\n    // },\r\n    // {\r\n    //   id: \"prev_wk\",\r\n    //   alias: \"Previous Week\",\r\n    //   dataType: tableau.dataTypeEnum.float\r\n    // },\r\n    // {\r\n    //   id: \"this_wk\",\r\n    //   alias: \"This Week\",\r\n    //   dataType: tableau.dataTypeEnum.float\r\n    // },\r\n    // {\r\n    //   id: \"delta_1\",\r\n    //   alias: \"Delta One Week\",\r\n    //   dataType: tableau.dataTypeEnum.float\r\n    // },\r\n    // {\r\n    //   id: \"delta_2\",\r\n    //   alias: \"Delta Two Weeks\",\r\n    //   dataType: tableau.dataTypeEnum.float\r\n    // }]\r\n\r\n    // let rates = {\r\n    //   id: \"rates\",\r\n    //   alias: \"Rates\",\r\n    //   columns: rate_schema\r\n    // };\r\n    \r\n    // Counts are integers, a separate table\r\n    let count_schema = [{\r\n      id: \"name\",\r\n      alias: \"Name of Metric\",\r\n      dataType: tableau.dataTypeEnum.int\r\n    },\r\n    {\r\n      id: \"this_wk\",\r\n      alias: \"This Week\",\r\n      dataType: tableau.dataTypeEnum.int\r\n    },\r\n    {\r\n      id: \"prev_wk\",\r\n      alias: \"Previous Week\",\r\n      dataType: tableau.dataTypeEnum.int\r\n    },\r\n    {\r\n      id: \"three_wk\",\r\n      alias: \"Three Weeks Ago\",\r\n      dataType: tableau.dataTypeEnum.int\r\n    },\r\n    \r\n ];\r\n\r\n    let counts = {\r\n      id: \"counts\",\r\n      alias: \"Counts\",\r\n      columns: count_schema\r\n    };\r\n\r\n    schemaCallback([counts]);\r\n  }\r\n\r\n  myConnector.getData = function (table, doneCallback) {\r\n    // let dates = tableau.connectionData.split(';')[1];\r\n    // let account = $('#accountID').val().trim();\r\n    // let key = $('#apiKey').val().trim();\r\n    let data = JSON.parse(tableau.connectionData)\r\n    let key = data.key\r\n\r\n    // Latest date\r\n    let end_date = new Date(data.end_date)\r\n    let month = end_date.getUTCMonth() + 1; //jan = 0\r\n    let day = end_date.getUTCDate();\r\n    let year = end_date.getUTCFullYear();\r\n    let new_date = year + \"-\" + month + \"-\" + day;\r\n\r\n    // Week ago date\r\n    let wks_1 = new Date().setDate(end_date.getDate() - 7);\r\n    let wks_1_month = wks_1.getUTCMonth() + 1;\r\n    let wks_1_day = wks_1.getUTCDate();\r\n    let wks_1_year = wks_1.getUTCFullYear();\r\n    let wks_1_date = wks_1_year + \"-\" + wks_1_month + \"-\" + wks_1_day;\r\n\r\n    // 2 Weeks ago date\r\n    let wks_2 = new Date().setDate(end_date.getDate() - 14);\r\n    let wks_2_month = wks_2.getUTCMonth() + 1;\r\n    let wks_2_day = wks_2.getUTCDate();\r\n    let wks_2_year = wks_2.getUTCFullYear();\r\n    let wks_2_date = wks_2_year + \"-\" + wks_2_month + \"-\" + wks_2_day;\r\n\r\n    // 3 weeks ago date\r\n    let wks_3 = new Date().setDate(end_date.getDate() - 21);\r\n    let wks_3_month = wks_3.getUTCMonth() + 1;\r\n    let wks_3_day = wks_3.getUTCDate();\r\n    let wks_3_year = wks_3.getUTCFullYear();\r\n    let wks_3_date = wks_3_year + \"-\" + wks_3_month + \"-\" + wks_3_day;\r\n\r\n    // month ago date\r\n    let monthAgo = new Date().setDate(end_date.getDate() - 30)\r\n    let monthAgoM = monthAgo.getUTCMonth() + 1;\r\n    let monthAgoD = monthAgo.getUTCDate();\r\n    let monthAgoY = monthAgo.getUTCFullYear();\r\n    let monthAgoDate = monthAgoY + \"-\" + monthAgoM + \"-\" + monthAgoD \r\n\r\n    let allTimeStartDate = \"2000-01-01\"\r\n\r\n    let base_url = \"https://cors-e.herokuapp.com/https://api.govdelivery.com/api/v2/accounts/\" + account \r\n\r\n    let bulletin_summary_1wk = base_url + `reports/bulletins/summary?start_date=${wks_1_date}&end_date=${new_date}` \r\n    let bulletin_summary_2wks = base_url + `reports/bulletins/summary?start_date=${wks_2_date}&end_date=${wks_1_date}` \r\n    let bulletin_summary_3wks = base_url + `reports/bulletins/summary?start_date=${wks_3_date}&end_date=${wks_2_date}` \r\n\r\n    // let subcriber_summary_1wk = base_url + `reports/subscriber_activity/summary?start_date=${wks_1_date}&end_date=${new_date}`\r\n    // let subcriber_summary_2wks = base_url + `reports/subscriber_activity/summary?start_date=${wks_2_date}&end_date=${new_date}`\r\n\r\n    let call_list = [\r\n      bulletin_summary_1wk,\r\n      bulletin_summary_2wks,\r\n      bulletin_summary_3wks\r\n    ]\r\n\r\n    async function get_data (calls) {\r\n      const results = calls.map(async url => {\r\n\r\n        tableau.log(\"api call: \" + url);\r\n\r\n        const response = await fetch(url, {\r\n          method: \"GET\",\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/hal+json',\r\n            'X-AUTH-TOKEN': key\r\n          }\r\n        })\r\n\r\n        return response.json()\r\n      })\r\n\r\n      const dump = await Promise.all(results)\r\n      const keys_ = await Object.keys(dump[0])\r\n      const wk1_vals = await Object.values(dump[0])\r\n      const wk2_vals = await Object.values(dump[1])\r\n      const wk3_vals = await Object.values(dump[2])\r\n      const zipped = await _.zip(keys_, wk1_vals, wk2_vals, wk3_vals)\r\n\r\n      \r\n      if (table.tableInfo.id == \"counts\") {\r\n        table.appendRows(\r\n          zipped.map( k => ({\r\n              \"name\":  k[0],\r\n              \"this_wk\": k[1],\r\n              \"prev_wk\": k[2], \r\n              \"three_wk\": k[3] \r\n            })\r\n          )\r\n        )\r\n        doneCallback()\r\n      }\r\n\r\n      // if (table.tableInfo.id == \"counts\") {\r\n        \r\n      // }\r\n\r\n    }\r\n\r\n  //   req.onload = function () {\r\n  //     let res = req.response\r\n  //     let jn = JSON.parse(res)\r\n  //     tableau.log(\"resp: \" + jn);\r\n  //     // FOR ARRAY:\r\n  //     // table.appendRows(\r\n  //     //     jn.map(function(result) {\r\n  //     //         return {\r\n  //     //             \"total_subscribers\" : result.total_subscribers,\r\n  //     //             \"deleted_subscribers\" : result.deleted_subscribers,\r\n  //     //             \"direct_subscribers\" : result.direct_subscribers\r\n  //     //         };\r\n  //     //     })\r\n  //     // )\r\n  //     // FOR OBJECT:\r\n  //     table.appendRows(\r\n  //       [{\r\n  //         \"total_subscribers\": jn.total_subscribers,\r\n  //         \"deleted_subscribers\": jn.deleted_subscribers,\r\n  //         \"direct_subscribers\": jn.direct_subscribers\r\n  //       }]\r\n  //     )\r\n  //     doneCallback()\r\n  //   }\r\n\r\n  //   req.send()\r\n  //   // fetch(apiCall,\r\n  //   //     {\r\n  //   //         method: \"GET\",\r\n  //   //         headers: myHeaders\r\n  //   //     })\r\n  //   //     .then(function(r) { \r\n  //   //         return r.json()\r\n  //   //     })\r\n  //   //     .then(function(j) { \r\n  //   //     tableau.log(\"resp: \" + j);\r\n  //   //     table.appendRows(\r\n  //   //     j.map(function(result) {\r\n  //   //         return {\r\n  //   //             \"total_subscribers\" : result.total_subscribers,\r\n  //   //             \"deleted_subscribers\" : result.deleted_subscribers,\r\n  //   //             \"direct_subscribers\" : result.direct_subscribers\r\n  //   //         };\r\n  //   //     })\r\n  //   //     )\r\n  //   //     doneCallback();\r\n  //   // })\r\n  // };\r\n\r\n    tableau.registerConnector(myConnector);\r\n\r\n    // Create event listeners for when the user submits the form\r\n    $(document).ready(function () {\r\n      $(\"#submitButton\").click(function () {\r\n\r\n        let pass = {\r\n          key: $('#apiKey').val().trim(),\r\n          end_date:  $('#end_date').val().trim(),\r\n        }\r\n\r\n        tableau.connectionData = JSON.stringify(pass)\r\n        \r\n        tableau.connectionName = \"Granicus WDC\"; // This will be the data source name in Tableau\r\n        \r\n        tableau.submit(); // This sends the connector object to Tableau\r\n      \r\n      });\r\n    });\r\n  }\r\n})();\r\n\r\n\r\n\r\n\r\n"},"lineCount":null}},"error":null,"hash":"8e070c78c979f81567a2242bc865b4e3","cacheData":{"env":{}}}